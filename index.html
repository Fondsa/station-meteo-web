<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Station M√©t√©o</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Station M√©t√©o</h1>

<div class="card">
  <h2>Capteurs</h2>
  <p>Ext√©rieur : <span id="temp-ext">--</span> ¬∞C</p>
  <p>Int√©rieur : <span id="temp-int">--</span> ¬∞C</p>
</div>

<div class="card">
  <h2>Lampe Ext√©rieure</h2>
  <button id="btn-lampe" class="btn">Allumer</button>
</div>

<button id="mode-btn" class="btn">Mode Nuit</button>

<!-- Firebase via CDN compat -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
  // üîπ Initialisation Firebase
  const firebaseConfig = {
    apiKey: "TA_CLE_API", // change si n√©cessaire
    authDomain: "projetfakirradio.firebaseapp.com",
    databaseURL: "https://projetfakirradio-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "projetfakirradio",
    storageBucket: "projetfakirradio.firebasestorage.app",
    messagingSenderId: "363899261538",
    appId: "1:363899261538:web:ad30da02b1485f5c2d373b",
    measurementId: "G-EZL8K5CS4Y"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const tempExtRef = db.ref("capteurs/exterieur/temperature");
  const tempIntRef = db.ref("capteurs/interieur/temperature");
  const lampeRef = db.ref("commande/lampe");
  const modeRef = db.ref("ui/mode");

  const btnLampe = document.getElementById("btn-lampe");
  const modeBtn = document.getElementById("mode-btn");

  // üîπ Temp√©ratures
  tempExtRef.on("value", snap => document.getElementById("temp-ext").textContent = snap.val() ?? "--");
  tempIntRef.on("value", snap => document.getElementById("temp-int").textContent = snap.val() ?? "--");

  // üîπ Lampe
  lampeRef.on("value", snap => btnLampe.textContent = snap.val() ? "√âteindre" : "Allumer");
  btnLampe.addEventListener("click", async () => {
    const snap = await lampeRef.once("value");
    lampeRef.set(!snap.val());
  });

  // üîπ Mode Jour/Nuit persistant
  modeRef.on("value", snap => {
    const mode = snap.val() || "jour";
    document.body.className = mode;
    modeBtn.textContent = mode === "jour" ? "Mode Nuit" : "Mode Jour";
  });

  modeBtn.addEventListener("click", async () => {
    const snap = await modeRef.once("value");
    const newMode = snap.val() === "jour" ? "nuit" : "jour";
    modeRef.set(newMode);
    document.body.className = newMode;
    modeBtn.textContent = newMode === "jour" ? "Mode Nuit" : "Mode Jour";
  });
</script>

</body>
</html>
